{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\godoi\\\\OneDrive\\\\Documents\\\\projetos-front-end\\\\new_fe_hp_game\\\\src\\\\pages\\\\pessoas\\\\components\\\\AutoCompleteCidade.tsx\",\n  _s = $RefreshSig$();\nimport { Autocomplete, CircularProgress, TextField } from '@mui/material';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { CidadesService } from '../../../shared/services/api/cidades/CidadesService';\nimport { useDebounce } from '../../../shared/hooks';\nimport { useField } from '@unform/core';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AutoCompleteCidade = ({\n  isExternalLoading = false\n}) => {\n  _s();\n  const {\n    fieldName,\n    registerField,\n    defaultValue,\n    error,\n    clearError\n  } = useField('cidadeId');\n  const [opcoes, setOpcoes] = useState([]);\n  const isFirstRender = useRef(true);\n  const [isLoading, setIsLoading] = useState(false);\n  const [busca, setBusca] = useState('');\n  const [selectedId, setSelectedId] = useState(defaultValue);\n  const {\n    debounce\n  } = useDebounce(500);\n  const realizarBusca = useCallback(() => {\n    // console.log(busca);\n    CidadesService.getAll(1, busca).then(result => {\n      setIsLoading(false);\n      if (result instanceof Error) {\n        //alert(result.message);\n      } else {\n        console.log(result);\n        setOpcoes(result.data.map(cidade => ({\n          id: cidade.id,\n          label: cidade.nome\n        })));\n      }\n    });\n  }, [busca]);\n  useEffect(() => {\n    registerField({\n      name: fieldName,\n      getValue: () => selectedId,\n      setValue: (_, newSelectedId) => setSelectedId(newSelectedId)\n    });\n  }, [registerField, fieldName, selectedId]);\n  useEffect(() => {\n    setIsLoading(true);\n    if (isFirstRender.current) {\n      isFirstRender.current = false;\n      realizarBusca();\n    } else {\n      debounce(realizarBusca);\n    }\n  }, [busca]);\n  const autoCompleteSelecetedOption = useMemo(() => {\n    if (!selectedId) return null;\n    const selectedOption = opcoes.find(opcao => opcao.id === selectedId);\n    if (!selectedOption) return null;\n    return selectedOption;\n  }, [selectedId, opcoes]);\n  return /*#__PURE__*/_jsxDEV(Autocomplete, {\n    openText: \"Abrir\",\n    closeText: \"Fechar\",\n    noOptionsText: \"Sem op\\xE7\\xF5es\",\n    loadingText: \"Carregando...\",\n    disablePortal: true,\n    options: opcoes,\n    loading: isLoading,\n    disabled: isExternalLoading,\n    onInputChange: (_, newValue) => setBusca(newValue),\n    value: autoCompleteSelecetedOption,\n    onChange: (_, newValue) => {\n      setSelectedId(newValue === null || newValue === void 0 ? void 0 : newValue.id);\n      setBusca('');\n      clearError();\n    },\n    popupIcon: isLoading || isExternalLoading ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n      size: 28\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }, this) : undefined,\n    renderInput: params => /*#__PURE__*/_jsxDEV(TextField, {\n      ...params,\n      label: \"Cidade\",\n      error: !!error,\n      helperText: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(AutoCompleteCidade, \"sMrsr0LwkdIHa435/FaUiGnZAvw=\", false, function () {\n  return [useField, useDebounce];\n});\n_c = AutoCompleteCidade;\nvar _c;\n$RefreshReg$(_c, \"AutoCompleteCidade\");","map":{"version":3,"names":["Autocomplete","CircularProgress","TextField","React","useCallback","useEffect","useMemo","useRef","useState","CidadesService","useDebounce","useField","jsxDEV","_jsxDEV","AutoCompleteCidade","isExternalLoading","_s","fieldName","registerField","defaultValue","error","clearError","opcoes","setOpcoes","isFirstRender","isLoading","setIsLoading","busca","setBusca","selectedId","setSelectedId","debounce","realizarBusca","getAll","then","result","Error","console","log","data","map","cidade","id","label","nome","name","getValue","setValue","_","newSelectedId","current","autoCompleteSelecetedOption","selectedOption","find","opcao","openText","closeText","noOptionsText","loadingText","disablePortal","options","loading","disabled","onInputChange","newValue","value","onChange","popupIcon","size","fileName","_jsxFileName","lineNumber","columnNumber","undefined","renderInput","params","helperText","_c","$RefreshReg$"],"sources":["C:/Users/godoi/OneDrive/Documents/projetos-front-end/new_fe_hp_game/src/pages/pessoas/components/AutoCompleteCidade.tsx"],"sourcesContent":["import { Autocomplete, CircularProgress, TextField } from '@mui/material';\r\nimport React, {\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n} from 'react';\r\nimport { CidadesService } from '../../../shared/services/api/cidades/CidadesService';\r\nimport { useDebounce } from '../../../shared/hooks';\r\nimport { useField } from '@unform/core';\r\n\r\ntype TAutoCompleteOption = {\r\n  id: number;\r\n  label: string;\r\n};\r\n\r\ninterface IAutoCompleteCidadeProps {\r\n  isExternalLoading?: boolean;\r\n}\r\n\r\nexport const AutoCompleteCidade: React.FC<IAutoCompleteCidadeProps> = ({\r\n  isExternalLoading = false,\r\n}) => {\r\n  const { fieldName, registerField, defaultValue, error, clearError } =\r\n    useField('cidadeId');\r\n\r\n  const [opcoes, setOpcoes] = useState<TAutoCompleteOption[]>([]);\r\n  const isFirstRender = useRef(true);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [busca, setBusca] = useState('');\r\n  const [selectedId, setSelectedId] = useState<number | undefined>(defaultValue);\r\n  const { debounce } = useDebounce(500);\r\n\r\n  const realizarBusca = useCallback(() => {\r\n    // console.log(busca);\r\n    CidadesService.getAll(1, busca).then((result) => {\r\n      setIsLoading(false);\r\n      if (result instanceof Error) {\r\n        //alert(result.message);\r\n      } else {\r\n        console.log(result);\r\n        setOpcoes(\r\n          result.data.map((cidade) => ({ id: cidade.id, label: cidade.nome }))\r\n        );\r\n      }\r\n    });\r\n  }, [busca]);\r\n\r\n  useEffect(() => {\r\n    registerField({\r\n      name: fieldName,\r\n      getValue: () => selectedId,\r\n      setValue: (_, newSelectedId) => setSelectedId(newSelectedId),\r\n    });\r\n  }, [registerField, fieldName, selectedId]);\r\n\r\n  useEffect(() => {\r\n    setIsLoading(true);\r\n    if (isFirstRender.current) {\r\n      isFirstRender.current = false;\r\n      realizarBusca();\r\n    } else {\r\n      debounce(realizarBusca);\r\n    }\r\n  }, [busca]);\r\n\r\n  const autoCompleteSelecetedOption = useMemo(() => {\r\n    if (!selectedId) return null;\r\n\r\n    const selectedOption = opcoes.find((opcao) => opcao.id === selectedId);\r\n    if (!selectedOption) return null;\r\n\r\n    return selectedOption;\r\n  }, [selectedId, opcoes]);\r\n\r\n  return (\r\n    <Autocomplete\r\n      openText='Abrir'\r\n      closeText='Fechar'\r\n      noOptionsText='Sem opções'\r\n      loadingText='Carregando...'\r\n      disablePortal\r\n      options={opcoes}\r\n      loading={isLoading}\r\n      disabled={isExternalLoading}\r\n      onInputChange={(_, newValue) => setBusca(newValue)}\r\n      value={autoCompleteSelecetedOption}\r\n      onChange={(_, newValue) => {\r\n        setSelectedId(newValue?.id);\r\n        setBusca('');\r\n        clearError();\r\n      }}\r\n      popupIcon={\r\n        isLoading || isExternalLoading ? (\r\n          <CircularProgress size={28} />\r\n        ) : undefined\r\n      }\r\n      renderInput={(params) => (\r\n        <TextField\r\n          {...params}\r\n          label='Cidade'\r\n          error={!!error}\r\n          helperText={error}\r\n        />\r\n      )}\r\n    />\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}